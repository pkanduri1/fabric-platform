# Simplified version - recommended for quick testing
batch:
  sources:
    hr:
      inputBasePath:  ${batch.defaults.inputBasePath}/hr
      outputBasePath: ${batch.defaults.outputBasePath}/hr
      stagingSchema:  ${batch.defaults.stagingSchema}
      destSchema:     ${batch.defaults.destSchema}

      jobs:
        p327:
          files:
            # Simple output path with date placeholder
            - target: ${batch.defaults.stagingSchema}.hr_master
              params:
                format: jdbc
                batchDateParam: ${batch.defaults.batchDateParam}
                batchDateValue: ${batch.defaults.batchDateValue}
                outputPath: ${batch.defaults.outputBasePath}/hr/p327-hr-${DATE}.txt
                fetchSize: "500"
                pageSize: "1000"
                query: >
                  SELECT *
                  FROM ${batch.defaults.stagingSchema}.HR_MASTER a where a.batch_date=
                  (select max(batch_date) from ${batch.defaults.stagingSchema}.batch_date_locator)

        atoctran:
            files:
              # Transaction type 200 - Full transaction record
              - transactionType: "200"
                target: ${batch.defaults.stagingSchema}.hr_master
                params:
                  format: jdbc
                  batchDateParam: ${batch.defaults.batchDateParam}
                  batchDateValue: ${batch.defaults.batchDateValue}
                  outputPath: ${batch.defaults.outputBasePath}/hr/atoctran_200_${DATE}.txt
                  fetchSize: "500"
                  pageSize: "1000"
                  query: >
                    SELECT 
                      '100020' as location_code,
                      acct_num,
                      '200' as transaction_type,
                      TO_CHAR(batch_date, 'YYYYMMDD') as batch_date,
                      '0' as cci,
                      '200000' as prort_location_cd,
                      acct_num as port_id,
                      acct_num as contact_id
                      FROM ${batch.defaults.stagingSchema}.HR_MASTER t
                      WHERE t.batch_date = (SELECT MAX(batch_date) 
                      FROM ${batch.defaults.stagingSchema}.batch_date_locator)

              # Transaction type 900 - Amount-focused transaction record  
              - transactionType: "900"
                target: ${batch.defaults.stagingSchema}.hr_master
                params:
                  format: jdbc
                  batchDateParam: ${batch.defaults.batchDateParam}
                  batchDateValue: ${batch.defaults.batchDateValue}
                  outputPath: ${batch.defaults.outputBasePath}/hr/atoctran_900_${DATE}.txt
                  fetchSize: "500"
                  pageSize: "1000"
                  query: >
                    SELECT  '100020' as location_code, acct_num, '900' as transaction_type,	 TO_CHAR(batch_date, 'YYYYMMDD') as batch_date, net_pay 
                    FROM ${batch.defaults.stagingSchema}.HR_MASTER t
                    WHERE t.batch_date = (SELECT MAX(batch_date) from ${batch.defaults.stagingSchema}.batch_date_locator)
        tranert:
           files:
             # Transaction type 32005 - Specific transaction record
             - transactionType: "32005"
               target: ${batch.defaults.stagingSchema}.hr_master
               params:
                  format: jdbc
                  batchDateParam: ${batch.defaults.batchDateParam}
                  batchDateValue: ${batch.defaults.batchDateValue}
                  outputPath: ${batch.defaults.outputBasePath}/hr/tranert_32005_${DATE}.txt
                  fetchSize: "500"
                  pageSize: "1000"
                  query: >
                        SELECT 
                        '100020' as location_code,
                        acct_num,
                        '32005' as transaction_type,
                        TO_CHAR(batch_date, 'YYYYMMDD') as batch_date,
                        '0' as cci,
                        '200000' as prort_location_cd,
                        acct_num as port_id,
                        acct_num as contact_id
                        FROM ${batch.defaults.stagingSchema}.HR_MASTER t
                        WHERE t.batch_date = (SELECT MAX(batch_date) 
                        FROM ${batch.defaults.stagingSchema}.batch_date_locator)			    
             - transactionType: "32010"
               target: ${batch.defaults.stagingSchema}.hr_master
               params:
                  format: jdbc
                  batchDateParam: ${batch.defaults.batchDateParam}
                  batchDateValue: ${batch.defaults.batchDateValue}
                  outputPath: ${batch.defaults.outputBasePath}/hr/tranert_32005_${DATE}.txt
                  fetchSize: "500"
                  pageSize: "1000"
                  query: >
                        SELECT 
                        '100020' as location_code,
                        acct_num,
                        '32005' as transaction_type,
                        TO_CHAR(batch_date, 'YYYYMMDD') as batch_date,
                        '0' as cci,
                        '200000' as prort_location_cd,
                        acct_num as port_id,
                        acct_num as contact_id
                        FROM ${batch.defaults.stagingSchema}.HR_MASTER t
                        WHERE t.batch_date = (SELECT MAX(batch_date) 
                        FROM ${batch.defaults.stagingSchema}.batch_date_locator)			    
             - transactionType: "32015"
               target: ${batch.defaults.stagingSchema}.hr_master
               params:
                  format: jdbc
                  batchDateParam: ${batch.defaults.batchDateParam}
                  batchDateValue: ${batch.defaults.batchDateValue}
                  outputPath: ${batch.defaults.outputBasePath}/hr/tranert_32005_${DATE}.txt
                  fetchSize: "500"
                  pageSize: "1000"
                  query: >
                        SELECT 
                        '100020' as location_code,
                        acct_num,
                        '32005' as transaction_type,
                        TO_CHAR(batch_date, 'YYYYMMDD') as batch_date,
                        '0' as cci,
                        '200000' as prort_location_cd,
                        acct_num as port_id,
                        acct_num as contact_id
                        FROM ${batch.defaults.stagingSchema}.HR_MASTER t
                        WHERE t.batch_date = (SELECT MAX(batch_date) 
                        FROM ${batch.defaults.stagingSchema}.batch_date_locator)			    
             - transactionType: "32020"
               target: ${batch.defaults.stagingSchema}.hr_master
               params:
                  format: jdbc
                  batchDateParam: ${batch.defaults.batchDateParam}
                  batchDateValue: ${batch.defaults.batchDateValue}
                  outputPath: ${batch.defaults.outputBasePath}/hr/tranert_32005_${DATE}.txt
                  fetchSize: "500"
                  pageSize: "1000"
                  query: >
                        SELECT 
                        '100020' as location_code,
                        acct_num,
                        '32005' as transaction_type,
                        TO_CHAR(batch_date, 'YYYYMMDD') as batch_date,
                        '0' as cci,
                        '200000' as prort_location_cd,
                        acct_num as port_id,
                        acct_num as contact_id
                        FROM ${batch.defaults.stagingSchema}.HR_MASTER t
                        WHERE t.batch_date = (SELECT MAX(batch_date) 
                        FROM ${batch.defaults.stagingSchema}.batch_date_locator)			    
             - transactionType: "32025"
               target: ${batch.defaults.stagingSchema}.hr_master
               params:
                  format: jdbc
                  batchDateParam: ${batch.defaults.batchDateParam}
                  batchDateValue: ${batch.defaults.batchDateValue}
                  outputPath: ${batch.defaults.outputBasePath}/hr/tranert_32005_${DATE}.txt
                  fetchSize: "500"
                  pageSize: "1000"
                  query: >
                        SELECT 
                        '100020' as location_code,
                        acct_num,
                        '32005' as transaction_type,
                        TO_CHAR(batch_date, 'YYYYMMDD') as batch_date,
                        '0' as cci,
                        '200000' as prort_location_cd,
                        acct_num as port_id,
                        acct_num as contact_id
                        FROM ${batch.defaults.stagingSchema}.HR_MASTER t
                        WHERE t.batch_date = (SELECT MAX(batch_date) 
                        FROM ${batch.defaults.stagingSchema}.batch_date_locator)			    
             - transactionType: "32075"
               target: ${batch.defaults.stagingSchema}.hr_master
               params:
                  format: jdbc
                  batchDateParam: ${batch.defaults.batchDateParam}
                  batchDateValue: ${batch.defaults.batchDateValue}
                  outputPath: ${batch.defaults.outputBasePath}/hr/tranert_32005_${DATE}.txt
                  fetchSize: "500"
                  pageSize: "1000"
                  query: >
                        SELECT 
                        '100020' as location_code,
                        acct_num,
                        '32005' as transaction_type,
                        TO_CHAR(batch_date, 'YYYYMMDD') as batch_date,
                        '0' as cci,
                        '200000' as prort_location_cd,
                        acct_num as port_id,
                        acct_num as contact_id
                        FROM ${batch.defaults.stagingSchema}.HR_MASTER t
                        WHERE t.batch_date = (SELECT MAX(batch_date) 
                        FROM ${batch.defaults.stagingSchema}.batch_date_locator)			    
								